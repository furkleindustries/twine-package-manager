{% extends 'base.html' %}

{% block extraheaders %}
<title>Twine Package Manager - Package ({{ package.name|default:'Error: no name' }})</title>
<meta
    name="description"
    content="{% if package.package.description %}{{ package.package.description }}{% else %}A detailed view of {% if package.package.name %}the {{ package.package.name}}{% else %}a Twine{% endif %} package.{% endif %}"
>
<link
    rel="stylesheet"
    href="/static/styles/packages/edit.css"
    type="text/css"
>
{% endblock %}

{% block content %}
<article>
    <form id="packageUpdate">
        {% csrf_token %}

        <h3>
            {{ package.name }}
        </h3>

        <div>
            <label for="description">
                <em>
                    Description
                </em>
            </label>

            <input
                id="description"
                name="description"
                value="{{ package.description }}"
            >
        </div>

        <div>
            <label>
                <em>
                    Date created
                </em>
            </label>

            <span
                id="date_created"
            >
                {{ package.date_created }}
            </span>
        </div>

        <div>
            <label>
                <em>
                    Date modified
                </em>
            </label>

            <span
                id="date_created"
            >
                {{ package.date_created }}
            </span>
        </div>

        <div>
            <label for="homepage">
                Package homepage
            </label>

            <input
                id="homepage"
                name="homepage"
                value="{{ package.homepage }}"
            >
        </div>

        <div>
            <label for="keywords">
                <em>
                    Keywords
                </em>
            </label>

            <input
                id="keywords"
                name="keywords"
                value="{{ package.keywords }}"
            >
        </div>

        {% if versions %}
        <div>
            <label for="default_version">
                <em>
                    Default version
                </em>
            </label>

            {% if versions|length > 1 %}
                <select
                    id="default_version"
                    name="default_version"
                >
                    {% for version in versions %}
                        <option {% if package.default_version == version %}selected{% endif %}>
                            {{ version.version_identifier }}
                        </option>
                    {% endfor %}
                </select>
            {% else %}
                <span>{{ package.default_version.version_identifier }}</span>
            {% endif %}
        </div>
        {% endif %}

        <label>
            <em>
                Versions
            </em>
        </label>

        <div>
            <div>
                <a href="/packages/{{ package.id }}/create_version/">
                    Create new version
                </a>
            </div>

            {% if versions %}
                <ul>
                    {% for version in versions %}
                        <li class="version">
                            <strong
                                class="versionIdentifier {% if package.default_version == version %} default{% endif %}"
                                href="/versions/{{ version.id }}/"
                                data-version-identifier="{{ version.version_identifier }}"
                            >
                                {{ version.version_identifier }}
                            </strong>

                            <a href="/versions/{{ version.id }}/edit/"
                            >Edit</a>

                            <a href="/versions/{{ version.id }}/delete/"
                            >Delete</a>
                        </li>
                    {% endfor %}
                </ul>
            {% elif versions is not None %}
                <p>
                    No versions created.
                </p>
            {% endif %}
        </div>

        <div>
            <label for="tag">
                Tag (to be used as you please)
            </label>

            <input
                id="tag"
                name="tag"
                value="{{ package.tag }}"
            >
        </div>

        <button id="submit" type="button">
            Update package
        </button>
    </form>

    <div>
        <a href="/packages/{{ package.id }}/delete/">
            Delete package
        </a>
    </div>

    <div class="error"></div>
</article>

<script src="/static/scripts/packages/defaultVersionSelector.js" async defer></script>

<script src="/static/scripts/editOnBeforeUnloadHandler.js" async defer></script>

{% include 'form_script.html' %}
{% endblock %}