{% extends 'base.html' %}

{% block extraheaders %}
<title>Twine Package Manager - Home</title>

<meta
    name="description"
    content="Twine Package Manager is a package manager for the Twine system, designed to allow simple sharing and reuse of code by creators from all aspects of Twine."
>
{% endblock %}

{% block content %}
<article class="container">
    <h1 class="page-title">
        Twine Package Manager
    </h1>

    <section class="introduction">
        <h2 class="introduction-title">
            Build and use new Twine macros, plugins, and formats
        </h2>

        <p>
            Twine Package Manager, or TwinePM, is a package manager for
            developers who make Twine modules, and for authors who want
            to make use of the pre-existing, proven labors of other
            community members in order to make their hypertext fiction
            and games even better.
        </p>
    </section> 

    {% if logged_in %}
        <section class="create-new-package">
            <h3 class="create-new-package-title">
                Create a new package
            </h3>

            <p>
                Got a cool idea? Made something useful or pretty for one of your
                stories? <a href="/packages/create/">Add something new</a> to
                the TwinePM ecosystem.
            </p>
        </section>
    {% else %}
        <section class="sign-up">
            <h3 class="sign-up-title">
                Sign up for free and start finding and creating new CSS
                themes, macros, syntax highlighters, and more.
            </h3>

            {% include "signup_link_widget.html" %}
        </section>
    {% endif %}

    <section class="twine-message">
        <h3 class="twine-message-title">
            Need Twine first?
        </h3>

        <p>
            Head over to
            <a href="//twinery.org">Twinery</a>
            to use the online version or download the desktop version.
            
            <button id="hideMessage">X</button>
        </p>
    </section>

    <section>
        <h3 class="newest-packages-title">
            Newest packages
        </h3>

        <ul class="package-list">
            {% for package in newest_packages %}
                <li class="package-list-item">
                    {% include "packages/package.html" %}
                </li>
            {% endfor %}
        </ul>
    </section>
</article>

<script id="hide-twine-message">
(function iife() {
    function hideTwineMessage() {
        var twineMessage = document.querySelector('.twine-message');
        if (twineMessage) {
            twineMessage.hidden = true;
            twineMessage.style.display = 'none';
        }
    }

    var hideMessage = document.querySelector('#hideMessage');
    if (hideMessage) {
        hideMessage.addEventListener('click', function hide() {
            localStorage.hideTwineMessage = 'true';
            hideTwineMessage();
        });
    }

    if (localStorage && localStorage['hideTwineMessage'] === 'true') {
        hideTwineMessage();
    }
})();
</script>
{% endblock %}